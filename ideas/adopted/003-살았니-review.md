# 003-살았니 (SafePin) — 4단계 PRD 정합성 판별 보고서 (v3)

> 검증일: 2026-01-31
> 대상: `ideas/003-살았니-prd.md` (PRD v1.2)
> 이전 검증: v1 → Major 2건으로 3단계 회귀, v2 → Minor 7건으로 3단계 회귀
> 본 리뷰: v1.2 반영 사항 재검증 + 전체 영역 최종 판정

---

## 이전 리뷰(v2) Minor 7건 반영 확인

| # | v2 지적 | 심각도 | v1.2 반영 여부 | 재판정 |
|---|---------|--------|---------------|--------|
| A-M1 | SOM과 수익 추정 유료 사용자 수 범위 불일치 | Minor | **해소** — §10-2에 "SOM과의 관계" 주석 추가: "SOM 3~6만은 낙관적 시나리오의 상한. 보수적/기본이 현실적 기대치" 명시 | **통과** |
| B-M1 | 무동의 긴급연락처 알림 발송의 법적 근거 미기술 | Minor | **해소** — §11 R7에 개인정보보호법 §15-1-5(급박한 생명·신체 이익), 정보통신망법 §50 단서(비영리 긴급 알림) 법적 논거 기술 + W10~W11 법률 자문 일정 로드맵 반영 | **통과** |
| C-M1 | 체크인 INSERT 시 next_deadline_at 계산 주체 미명시 | Minor | **해소** — F10 `calculate_next_deadline()` BEFORE INSERT 트리거 추가. 서버에서 `user_settings.check_in_interval_hours` 조회 후 자동 계산. 클라이언트 전송값도 서버 기준으로 재계산하여 정합성 보장 | **통과** |
| C-M2 | 무료 사용자 주기 변경 DB 레벨 강제 메커니즘 부재 | Minor | **해소** — F11 `enforce_free_interval()` BEFORE UPDATE 트리거 추가. `subscriptions.plan = 'free'`이고 `check_in_interval_hours != 24`이면 RAISE EXCEPTION으로 DB 레벨 강제 | **통과** |
| C-M3 | pg_net/pg_cron Supabase 확장 기술 스택 미명시 | Minor | **해소** — §7-1 기술 스택 표에 pg_cron(역할: 미응답 감지/유예 만료/알림 재시도 스케줄링)과 pg_net(역할: DB Function에서 Edge Function HTTP 호출) 행 추가 | **통과** |
| D-M1 | HomeScreen API 참조 `GET /checkins/latest` 미존재 경로 | Minor | **해소** — §8-2 HomeScreen API 행이 `POST /rest/v1/checkins`(체크인) + `POST /rest/v1/rpc/get_user_checkin_status`(상태 조회)로 수정 | **통과** |
| D-M2 | LoginScreen UI 구성 상세 누락 | Minor | **해소** — §8-2에 LoginScreen UI 구성표 추가: 상단(앱 로고+슬로건), 중앙(소셜 로그인 3버튼 세로 배치, 브랜드 가이드라인 준수), 하단(이용약관·개인정보처리방침 링크) | **통과** |

**v2 Minor 7건 전체 해소 확인.**

---

## 영역별 판정 요약

| 영역 | 판정 | Critical | Major | Minor |
|------|------|----------|-------|-------|
| A. 사업성 검증 | **통과** | 0 | 0 | 0 |
| B. 리스크 검증 | **통과** | 0 | 0 | 0 |
| C. 기술 검증 | **통과** | 0 | 0 | 2 |
| D. 문서 품질 검증 | **통과** | 0 | 0 | 1 |
| **합계** | | **0** | **0** | **3** |

---

## A. 사업성 검증 — 통과

| 점검 항목 | 결과 | 근거 |
|----------|------|------|
| PRD ↔ 2단계 시장 규모 일치 | ✅ | TAM 804만(1.93조), SAM 503만(2,414억), SOM 3~6만 유료(7.2~14.4억) — 시장분석 §1과 완전 일치 |
| PRD ↔ 2단계 경쟁분석 일치 | ✅ | Demumu/Snug Safety/루키스/정부 서비스 분석이 경쟁분석 §1~§4와 일치. 차별화 6개 항목 정합 |
| 차별점 방어 가능성 | ✅ | 카카오톡 알림톡(외국 경쟁자 진입장벽), 한국어 네이티브, 선점 우위. 진입장벽 낮음은 인식하고 빠른 실행으로 대응 |
| 수익 모델 구체성/현실성 | ✅ | 무료/프리미엄(월 ₩3,900/연 ₩39,000) 명확. 3개 시나리오 추정 + SOM 관계 설명 완비 |
| TAM/SAM/SOM 논리적 근거 | ✅ | 각 단계 축소 근거(연령→불안 경험→유료 전환) + 출처(국가데이터처, Korea Herald) 명시 |

---

## B. 리스크 검증 — 통과

| 점검 항목 | 결과 | 근거 |
|----------|------|------|
| 핵심 리스크 식별 완전성 | ✅ | 사업(R1~R3), 기술(R4~R5), 법률(R6~R7), 운영(R8), 의존성(R9~R10) 총 10개 리스크 |
| 리스크 대응 방안 구체성 | ✅ | 각 리스크별 심각도·발생확률·대응방안. R7은 법적 논거(개인정보보호법·정보통신망법) + 법률 자문 일정(W10~W11) 포함 |
| 외부 API/플랫폼 의존성 관리 | ✅ | §12-2에 5개 외부 의존성별 리스크·대안 완비 |

---

## C. 기술 검증 — 통과 (Minor 2건)

| 점검 항목 | 결과 | 근거 |
|----------|------|------|
| RN + TS + Supabase 구현 가능성 | ✅ | §7-1에 17개+ 라이브러리(pg_cron/pg_net 포함) 선정 사유 완비. 핵심 기능 모두 해당 스택으로 구현 가능 |
| 1인 개발 규모 적정성 | ✅ | P0 14개, DB 테이블 7개, Edge Function 7개, DB Function 11개(F1~F11). 관리 가능한 규모 |
| 3개월 MVP 범위 현실성 | ✅ | 12주 4단계 로드맵(기반→핵심→수익화→QA). 주별 마일스톤 기능 단위 분리 |
| DB 스키마 ↔ 요구사항 정합 | ✅ | 7개 테이블 CREATE TABLE, FK/인덱스/RLS 완비. F10(next_deadline_at 자동 계산), F11(무료 주기 강제) 트리거로 데이터 정합성 보장 |
| 장애 시나리오 대응 | ✅ | 오프라인 체크인 + 동기화, SMS 재시도 3회, 카카오→SMS 폴백, 5분 catch-up cron, 오알림 자동 취소 |
| 오프라인 우선 설계 구체성 | ✅ | MMKV/op-sqlite 역할 분담 9항목, 동기화 큐 5단계, 지수 백오프 재시도, Server Wins 충돌 해결 |
| DB Function SQL 본문 완성도 | ✅ | F1~F11 전체 11개 함수 SQL 본문 + pg_cron 스케줄 등록 구문. 스텁 없음 |
| TypeScript 인터페이스 완성도 | ✅ | §7-6-3에 모든 API 요청/응답 인터페이스 + 공통 타입 8개 |
| Zustand Store 구조 정의 | ✅ | 7개 Store별 역할·상태 필드·persist 전략·actions 완비 |

**발견된 Minor 이슈:**

| # | 내용 | 심각도 | 유형 |
|---|------|--------|------|
| C-M1 | F2 `check_overdue_checkins()`의 `DISTINCT ON` + `NOT EXISTS` 조합 쿼리가 대규모(수십만 체크인) 시 성능 저하 가능성. 현재 인덱스(`idx_checkins_deadline_asc`)로 커버되나, 운영 시 `EXPLAIN ANALYZE` 확인 권장 | Minor | 문서 결함 |
| C-M2 | F5 `get_user_checkin_status()`의 스트릭 계산이 ROW_NUMBER 기반 복잡 서브쿼리. 체크인 기록 수천 건 이상 시 성능 이슈 가능. 운영 확대 시 별도 streak 칼럼 또는 materialized view 최적화 검토 권장 | Minor | 문서 결함 |

---

## D. 문서 품질 검증 — 통과 (Minor 1건)

| 점검 항목 | 결과 | 근거 |
|----------|------|------|
| 목표·기능·기술 명세 간 모순 | ✅ 없음 | Executive Summary → FR → DB/API → UI 명세 일관. 무료/유료 분기가 수익 모델·AC·DB 트리거(F11)까지 일관 |
| 15개 섹션 존재 | ✅ | §1~§15 전체 존재 |
| KPI 구체성/측정 가능성 | ✅ | 15개 KPI, 정의·목표·측정 방법 모두 명시 |
| P0 수용 기준 (AC-XX-X 형식) | ✅ | FR-01~FR-14 전체 AC 존재, 검증 가능한 조건문 형태 |
| User Story 커버리지 | ✅ | 7개 Epic, 27개 User Story (최소 15개 초과) |
| Screen Map / UI 명세 | ✅ | 네비게이션 트리 + 8개 핵심 화면 UI 구성·데이터·API 매핑 (LoginScreen 포함) |
| 기능-테이블-API 매핑표 | ✅ | §7-8에 14개 P0 기능 전체 매핑 완료 |

**발견된 Minor 이슈:**

| # | 내용 | 심각도 | 유형 |
|---|------|--------|------|
| D-M1 | §8-2 TimelineScreen API 행에 `GET /checkins?month=YYYY-MM`, `GET /alert-logs?month=YYYY-MM`으로 표기. 실제 API 설계(§7-6-2)에서는 `POST /rest/v1/rpc/get_checkins_by_month` (RPC). 화면 명세와 실제 엔드포인트 형식 경미한 불일치 | Minor | 문서 결함 |

---

## 전체 미달 목록

| # | 영역 | 심각도 | 유형 | 내용 |
|---|------|--------|------|------|
| C-M1 | 기술 | Minor | 문서 결함 | F2 check_overdue_checkins 대규모 데이터 시 쿼리 성능 — 운영 시 EXPLAIN ANALYZE 확인 권장 |
| C-M2 | 기술 | Minor | 문서 결함 | F5 get_user_checkin_status 스트릭 계산 서브쿼리 복잡성 — 운영 확대 시 최적화 검토 권장 |
| D-M1 | 문서품질 | Minor | 문서 결함 | TimelineScreen API 경로 표기와 실제 엔드포인트(RPC) 형식 경미한 불일치 |

---

## 수정 지침

해당 없음 — Critical/Major 미달 사항이 없으므로 3단계 회귀 수정 지침을 첨부하지 않는다.

Minor 3건은 모두 개발 단계에서 자연스럽게 해소되는 수준이며, PRD의 Task Master 투입 적합성을 저해하지 않는다:

| # | 해소 시점 | 방향 |
|---|----------|------|
| C-M1 | 개발 단계 (W4~W5) | pg_cron 함수 테스트 시 `EXPLAIN ANALYZE`로 쿼리 플랜 확인, 필요 시 인덱스 조정 |
| C-M2 | 운영 확대 시 | 사용자 규모 1만+ 도달 후 스트릭 계산 방식 최적화 검토 (별도 칼럼/캐시) |
| D-M1 | 개발 단계 (W6) | TimelineScreen 구현 시 자연스럽게 올바른 RPC 엔드포인트 사용 |

---

## 최종 판정

### **통과** ✅

| 판정 기준 | 결과 |
|----------|------|
| Critical 미달 | 0건 |
| Major 미달 | 0건 |
| Minor 미달 | 3건 (모두 문서 결함, 개발 단계 해소 가능) |
| 아이디어 결함 | 0건 |

**판정 근거:**

1. **사업성**: TAM/SAM/SOM 수치가 2단계 산출물과 완전 일치, 수익 모델이 SOM과 정합, 차별점 방어 전략 합리적
2. **리스크**: 5개 유형 10개 리스크 식별, 법적 논거(R7) 보강 완료, 외부 의존성 관리 체계적
3. **기술**: 11개 DB Function(F10 next_deadline_at 자동 계산, F11 무료 주기 강제 포함) SQL 완성, TypeScript 인터페이스 완비, 7개 Zustand Store, 오프라인 동기화 설계 상세
4. **문서 품질**: 15개 섹션 완전, 27개 User Story, 46개 AC, 8개 화면 UI 명세(LoginScreen 포함), 기능-테이블-API 매핑표 완비, v2 Minor 7건 전체 해소

PRD v1.2는 **Task Master에 투입하여 즉시 개발 태스크로 분해할 수 있는 수준**으로 판단된다.

---

## 다음 단계

> **5단계 채택**: `/stage-5 003-살았니 채택`
